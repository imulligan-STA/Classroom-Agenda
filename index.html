<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Classroom Agenda</title>
<style>
  body { font-family: Arial, sans-serif; background: #f5f5f5; margin:0; padding:20px; }
  .header { text-align:center; margin-bottom:20px; }
  .header h1 { font-size:2em; margin:0; }
  .section { margin-bottom:30px; }
  .section h2 { border-bottom: 2px solid #333; padding-bottom:5px; }
  .item { display:flex; align-items:flex-start; margin:10px 0; background:#fff; padding:10px 15px; border-radius:8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);}
  .icon { font-size:1.5em; margin-right:15px; }
  .content h3 { margin:0; font-size:1.1em; }
  .content p { margin:3px 0 0; font-size:0.95em; color:#555; }
  .archive-button { display:block; margin: 20px auto; padding:10px 20px; font-size:1em; background:#007BFF; color:#fff; border:none; border-radius:5px; cursor:pointer; text-decoration:none; text-align:center; }
  .archive-button:hover { background:#0056b3; }
</style>
</head>
<body>

<div class="header">
  <h1 id="date-header">Loading...</h1>
</div>

<div class="section" id="focus-section">
  <h2>Focus</h2>
</div>

<div class="section" id="next-section">
  <h2>Next</h2>
</div>

<a href="#" class="archive-button" id="archive-button">View Archived Agendas</a>

<script>
  const SHEET_ID = "YOUR_SHEET_ID_HERE"; // Replace with your sheet ID
  const SHEET_URL = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json`;

  fetch(SHEET_URL)
    .then(res => res.text())
    .then(data => {
      const json = JSON.parse(data.substring(47, data.length - 2));
      const rows = json.table.rows;

      let focusItems = [];
      let nextItems = [];
      let headerText = "";

      rows.forEach((row, index) => {
        // Skip the first row (column headers)
        if (index === 0) return;

        const section = row.c[1] ? row.c[1].v.toLowerCase() : "";
        const icon = row.c[2] ? row.c[2].v : "";
        const title = row.c[3] ? row.c[3].v : "";
        const description = row.c[4] ? row.c[4].v : "";
        const header = row.c[5] ? row.c[5].v : "";

        if (section === "header" && header) {
          headerText = header;
        } else if(section === "focus") {
          focusItems.push({icon, title, description});
        } else if(section === "next") {
          nextItems.push({icon, title, description});
        }
      });

      document.getElementById("date-header").textContent = headerText || "Today's Agenda";

      const renderItems = (items, sectionId) => {
        const container = document.getElementById(sectionId);
        items.forEach(item => {
          const div = document.createElement("div");
          div.className = "item";
          div.innerHTML = `<div class="icon">${item.icon}</div>
                           <div class="content"><h3>${item.title}</h3><p>${item.description}</p></div>`;
          container.appendChild(div);
        });
      };

      renderItems(focusItems, "focus-section");
      renderItems(nextItems, "next-section");

      // Archive button link
      document.getElementById("archive-button").href = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/edit#gid=0`; 
    })
    .catch(err => console.error("Error loading sheet:", err));
</script>

</body>
</html>
